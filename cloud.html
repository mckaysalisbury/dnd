<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8"/>
        <title>Cloud Castle</title>
        <style>
            body {
                background-image: url("iceRocks.jpg");
                background-color: rgba(255, 255, 255, 0.4);
                background-blend-mode: overlay;
                text-align: center;
                font-family: fantasy;
                width: 899px;
                margin: 0 auto;
            }
            div {
                /* border: 1px solid black; */
                display: inline-block;
                margin: 5px;
                width: 200px;
                height: 200px;
                line-height: 200px;
                font-size: 30pt;
                vertical-align: middle;
                /* font-weight: bold; */
                /* text-shadow:
                    -1px -1px 0 #000,
                    1px -1px 0 #000,
                    -1px 1px 0 #000,
                    1px 1px 0 #000; */
            }
        </style>
        <script>
            const params = new URLSearchParams(window.location.search);

            let activated = new Set(["south", "east", "clear", "unveil", "calm"]);
            let heading = parseInt(params["heading"] ?? 180)

            const data = {
                clockwise: {
                    language: "dwarf",
                    text: "ᛋᚢᚾ",
                    translation: "Sun",
                },
                north: {
                    language: "dwarf",
                    text: "ᚾᛟᚱᚦ",
                    translation: "North",
                },
                up: {
                    language: "dwarf",
                    text: "ᚱᛁᛋᛠ",
                    translation: "Rise"
                },
                home: {
                    language: "giant",
                    text: "σπίτι",
                    translation: "Home"
                },
                west: {
                    language: "dwarf",
                    text: "ᚹᛖᛥ",
                    translation: "West",
                },
                stop: {
                    language: "dwarf",
                    text: "ᚨᚾᛣᛟᚱ",
                    translation: "Anchor",
                },
                east: {
                    language: "dwarf",
                    text: "ᛖᚨᛥ",
                    translation: "East",
                },
                alarm: {
                    language: "giant",
                    text: "ξυπνητήρι",
                    translation: "Alarm"
                },
                counter: {
                    language: "dwarf",
                    text: "ᚹᛁᛞᛞᛖᚱ",
                    translation: "Widder"
                },
                south: {
                    language: "dwarf",
                    text: "ᛋᛟᚢᚦ",
                    translation: "North",
                },
                down: {
                    language: "dwarf",
                    text: "ᛋᛁᚾᛣ",
                    translation: "Sink",
                },
                clear: {
                    language: "giant",
                    text: "καθαρίσετε",
                    translation: "Clear",
                },
                veil: {
                    language: "giant",
                    text: "πέπλο",
                    translation: "Veil",
                },
                unveil: {
                    language: "giant",
                    text: "αφαιρέσω",
                    translation: "Unveil",
                },
                storm: {
                    language: "giant",
                    text: "θύελλα",
                    translation: "Storm",
                },
                calm: {
                    language: "giant",
                    text: "ήρεμο",
                    translation: "Calm",
                },
            }
            exclusiveSets = [
                new Set(["north", "south", "stop", "home"]),
                new Set(["east", "west", "stop", "home"]),
                new Set(["up", "down", "stop", "home"]),
                new Set(["clockwise", "counter", "stop", "home"]),
                new Set(["alarm", "clear"]),
                new Set(["veil", "unveil"]),
                new Set(["storm", "calm"]),
            ]

            function inPlaceDifference(left, right) {
                for (const item of right) {
                    left.delete(item);
                }
            }
            function setDifference(left, right) {
                const difference = new Set(left);
            }
            function activate(pressed) {
                for (const set of exclusiveSets) {
                    if (set.has(pressed)) {
                        inPlaceDifference(activated, set);
                    }
                }
                activated.add(pressed);
                update();
            }
            function setup() {
                for (const id in data) {
                    const div = document.createElement("div");
                    div.id = id;
                    div.innerText = params.has(data[id].language) ? data[id].translation : data[id].text;
                    div.addEventListener('click', () => activate(id));
                    document.body.appendChild(div);
                }
                update();
            }

            function update() {
                for (const id in data) {
                    document.getElementById(id).style.color = activated.has(id) ? "#0f0" : "#00f";
                }
                document.getElementById('heading').innerText = heading;
            }
        </script>
    </head>
    <body>
        <span id="heading" style="color:white;font-size: 5pt;">0</div>
    </body>
    <script>
        setup();
    </script>
</html>